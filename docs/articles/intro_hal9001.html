<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fitting the Highly Adaptive Lasso with `hal9001` • hal9001</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Fitting the Highly Adaptive Lasso with `hal9001`">
<meta property="og:description" content="hal9001">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115145808-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115145808-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hal9001</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="https://tlverse.org">tlverse</a>
</li>
<li>
  <a href="../articles/intro_hal9001.html">Overview</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/tlverse/hal9001">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Fitting the Highly Adaptive Lasso with <code>hal9001</code>
</h1>
                        <h4 class="author">
<a href="https://nimahejazi.org">Nima Hejazi</a> and <a href="https://github.com/jeremyrcoyle">Jeremy Coyle</a>
</h4>
            
            <h4 class="date">2021-04-09</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/tlverse/hal9001/blob/master/vignettes/intro_hal9001.Rmd"><code>vignettes/intro_hal9001.Rmd</code></a></small>
      <div class="hidden name"><code>intro_hal9001.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The <em>highly adaptive Lasso</em> (HAL) is a flexible machine learning algorithm that nonparametrically estimates a function based on available data by embedding a set of input observations and covariates in an extremely high-dimensional space (i.e., generating basis functions from the available data). For an input data matrix of <span class="math inline">\(n\)</span> observations and <span class="math inline">\(d\)</span> covariates, the number of basis functions generated is approximately <span class="math inline">\(n \cdot 2^{d - 1}\)</span>. To select a set of basis functions from among the full set generated, the Lasso is employed. The <code>hal9001</code> R package provides an efficient implementation of this routine, relying on the <code>glmnet</code> R package for compatibility with the canonical Lasso implementation while still providing a (faster) custom C++ routine for using the Lasso with an input matrix composed of indicator functions. Consider consulting <span class="citation">Benkeser and van der Laan (2016)</span>, <span class="citation">(<span class="citeproc-not-found" data-reference-id="vdl2015generally"><strong>???</strong></span>)</span>, <span class="citation">van der Laan (2017)</span> for detailed theoretical descriptions of the highly adaptive Lasso and its various optimality properties.</p>
<hr>
</div>
<div id="preliminaries" class="section level2">
<h2 class="hasAnchor">
<a href="#preliminaries" class="anchor"></a>Preliminaries</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com">data.table</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="co"># simulation constants</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">467392</span><span class="op">)</span>
<span class="va">n_obs</span> <span class="op">&lt;-</span> <span class="fl">500</span>
<span class="va">n_covars</span> <span class="op">&lt;-</span> <span class="fl">3</span>

<span class="co"># make some training data</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span><span class="op">(</span><span class="va">n_covars</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n_obs</span><span class="op">)</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n_obs</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>

<span class="co"># make some testing data</span>
<span class="va">test_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span><span class="op">(</span><span class="va">n_covars</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n_obs</span><span class="op">)</span><span class="op">)</span>
<span class="va">test_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n_obs</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></code></pre></div>
<p>Let’s look at simulated data:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></code></pre></div>
<pre><code>##             [,1]       [,2]       [,3]
## [1,]  2.44102981 -0.4337909  0.4670282
## [2,] -1.21932335  0.3336395  0.8894277
## [3,] -0.40613567 -0.3869374  0.3474353
## [4,] -1.09760477 -1.4663219 -0.1173214
## [5,]  0.23710498  1.2565812  1.8049389
## [6,]  0.06810091 -0.7020905  0.9301941</code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></code></pre></div>
<pre><code>## [1]  0.2372289 -0.6023415 -0.7569124 -1.8021339  1.0589707 -0.3373555</code></pre>
<hr>
</div>
<div id="using-the-highly-adaptive-lasso" class="section level2">
<h2 class="hasAnchor">
<a href="#using-the-highly-adaptive-lasso" class="anchor"></a>Using the Highly Adaptive Lasso</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tlverse/hal9001">hal9001</a></span><span class="op">)</span></code></pre></div>
<pre><code>## Loading required package: Rcpp</code></pre>
<pre><code>## hal9001 v0.3.0: The Scalable Highly Adaptive Lasso
## note: fit_hal defaults have changed. See ?fit_hal for details</code></pre>
<!-- ### Fitting the HAL model: "lassi" -->
<!-- Our custom implementation of the Lasso has been dubbed _lassi_. For the purposes -->
<!-- of HAL, it is faster than using the standard `glmnet` approach, but it is not -->
<!-- yet available for generalized linear models (i.e., iteratively re-weighted least -->
<!-- squares has not yet been implemented). -->
<!-- ```{r fit-hal-lassi} -->
<!-- hal_fit1 <- fit_hal(X = x, Y = y, fit_type = "lassi") -->
<!-- hal_fit1$times -->
<!-- ``` -->
<!-- ```{r results-hal-lassi} -->
<!-- hal_fit1 -->
<!-- ``` -->
<div id="fitting-the-model-glmnet" class="section level3">
<h3 class="hasAnchor">
<a href="#fitting-the-model-glmnet" class="anchor"></a>Fitting the model: <code>glmnet</code>
</h3>
<p>HAL uses the popular <code>glmnet</code> R package for the lasso step:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hal_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formula_hal.html">fit_hal</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">x</span>, Y <span class="op">=</span> <span class="va">y</span>, fit_type <span class="op">=</span> <span class="st">"glmnet"</span><span class="op">)</span>
<span class="va">hal_fit</span><span class="op">$</span><span class="va">times</span></code></pre></div>
<pre><code>##                   user.self sys.self elapsed user.child sys.child
## enumerate_basis       0.026    0.000   0.026          0         0
## design_matrix         0.138    0.008   0.146          0         0
## reduce_basis          0.000    0.000   0.000          0         0
## remove_duplicates     0.000    0.000   0.000          0         0
## lasso                 2.185    0.031   2.221          0         0
## total                 2.351    0.039   2.395          0         0</code></pre>
<p>While the raw output object may be examined, it has (usually large) slots that make quick examination challenging. Instead, we recommend the <code>summary</code> method, which provides an interpretable table of basis functions with non-zero coefficients.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">hal_fit</span><span class="op">)</span><span class="op">$</span><span class="va">table</span></code></pre></div>
<pre><code>##             coef                                                  term
## 1: -1.7687874362                                             Intercept
## 2:  0.1726315141                   I(1,2 &gt;= -3.2242)*I(1,3 &gt;= -3.0377)
## 3:  0.0200119716                   I(1,3 &gt;= -0.6451)*I(2,3 &gt;= -3.2886)
## 4:  0.0083551475 I(1,2 &gt;= -0.7397)*I(1,3 &gt;= -3.0377)*I(2,3 &gt;= -1.8899)
## 5:  0.0021217969  I(1,2 &gt;= -3.2242)*I(1,3 &gt;= -0.593)*I(2,3 &gt;= -1.5283)
## 6: -0.0005975216  I(1,2 &gt;= 0.3049)*I(1,3 &gt;= -1.4075)*I(2,3 &gt;= -3.2886)
## 7: -0.0245964275  I(1,2 &gt;= -3.2242)*I(1,3 &gt;= 0.4993)*I(2,3 &gt;= -3.2886)</code></pre>
</div>
<div id="reducing-basis-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#reducing-basis-functions" class="anchor"></a>Reducing basis functions</h3>
<p>As described in <span class="citation">Benkeser and van der Laan (2016)</span>, the HAL algorithm operates by first constructing a set of basis functions and subsequently fitting a Lasso model with this set of basis functions as the design matrix. Several approaches are considered for reducing this set of basis functions: 1. Removing duplicated basis functions (done by default in the <code>fit_hal</code> function), 2. Removing basis functions that correspond to only a small set of observations; a good rule of thumb is to scale with <span class="math inline">\(\frac{1}{\sqrt{n}}\)</span>.</p>
<p>The second of these two options may be invoked by specifying the <code>reduce_basis</code> argument to the <code>fit_hal</code> function:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hal_fit_reduced</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formula_hal.html">fit_hal</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">x</span>, Y <span class="op">=</span> <span class="va">y</span>, fit_type <span class="op">=</span> <span class="st">"glmnet"</span>,
                           reduce_basis <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">hal_fit_reduced</span><span class="op">$</span><span class="va">times</span></code></pre></div>
<pre><code>##                   user.self sys.self elapsed user.child sys.child
## enumerate_basis       0.021    0.000   0.021          0         0
## design_matrix         0.146    0.000   0.145          0         0
## reduce_basis          0.000    0.000   0.000          0         0
## remove_duplicates     0.000    0.000   0.000          0         0
## lasso                 1.737    0.012   1.748          0         0
## total                 1.905    0.012   1.916          0         0</code></pre>
<p>In the above, all basis functions with fewer than 4.472136% of observations meeting the criterion imposed are automatically removed prior to the Lasso step of fitting the HAL regression. The results appear below</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">hal_fit_reduced</span><span class="op">)</span><span class="op">$</span><span class="va">table</span></code></pre></div>
<pre><code>##             coef                                                  term
## 1: -1.7687874362                                             Intercept
## 2:  0.1726315141                   I(1,2 &gt;= -3.2242)*I(1,3 &gt;= -3.0377)
## 3:  0.0200119716                   I(1,3 &gt;= -0.6451)*I(2,3 &gt;= -3.2886)
## 4:  0.0083551475 I(1,2 &gt;= -0.7397)*I(1,3 &gt;= -3.0377)*I(2,3 &gt;= -1.8899)
## 5:  0.0021217969  I(1,2 &gt;= -3.2242)*I(1,3 &gt;= -0.593)*I(2,3 &gt;= -1.5283)
## 6: -0.0005975216  I(1,2 &gt;= 0.3049)*I(1,3 &gt;= -1.4075)*I(2,3 &gt;= -3.2886)
## 7: -0.0245964275  I(1,2 &gt;= -3.2242)*I(1,3 &gt;= 0.4993)*I(2,3 &gt;= -3.2886)</code></pre>
</div>
<div id="obtaining-model-predictions" class="section level3">
<h3 class="hasAnchor">
<a href="#obtaining-model-predictions" class="anchor"></a>Obtaining model predictions</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># training sample prediction for HAL vs HAL9000</span>
<span class="va">mse</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">preds</span>, <span class="va">y</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">preds</span> <span class="op">-</span> <span class="va">y</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">preds_hal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">hal_fit</span>, new_data <span class="op">=</span> <span class="va">x</span><span class="op">)</span>
<span class="va">mse_hal</span> <span class="op">&lt;-</span> <span class="fu">mse</span><span class="op">(</span>preds <span class="op">=</span> <span class="va">preds_hal</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>
<span class="va">mse_hal</span></code></pre></div>
<pre><code>## [1] 0.1940649</code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">oob_hal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">hal_fit</span>, new_data <span class="op">=</span> <span class="va">test_x</span><span class="op">)</span>
<span class="va">oob_hal_mse</span> <span class="op">&lt;-</span> <span class="fu">mse</span><span class="op">(</span>preds <span class="op">=</span> <span class="va">oob_hal</span>, y <span class="op">=</span> <span class="va">test_y</span><span class="op">)</span>
<span class="va">oob_hal_mse</span></code></pre></div>
<pre><code>## [1] 1.540186</code></pre>
</div>
<div id="specifying-smoothness-of-fit-and-improving-runtime-with-the-num_knots" class="section level3">
<h3 class="hasAnchor">
<a href="#specifying-smoothness-of-fit-and-improving-runtime-with-the-num_knots" class="anchor"></a>Specifying smoothness of fit and improving runtime with the <code>num_knots</code>
</h3>
<p>One might wish to enforce smoothness on the functional form of the HAL fit. This can be done using the “smoothness_orders” argument. Setting <code>smoothness_orders = 0</code> gives a piece-wise constant fit, allowing for discontinuous jumps in the function. This is useful if one does not want to assume any smoothness of the “true” function (not even continuity). Setting <code>smoothness_orders = 1</code> gives a piece-wise linear fit which is continuous and mostly differentiable. In general <code>smoothness_orders = k</code> corresponds to a piece-wise polynomial fit of degree k. Mathematically, <code>smoothness_orders = k</code> corresponds with finding the best fit under the constraint that the total variation of the function’s k-th deriviative is bounded by some constant (chosen by CV).</p>
<p>Let us see this in action. We will use the num_knots argument to increase the coarseness of the approximation so that the difference between smooth and unsmooth fits is more clear (see next section). Specifically, we set <code>num_knots = 7</code>. The argument num_knots allows one to specify the number of knot points used to generate the basis functions (for each interaction degree). This effectivelly reduces the total number of basis functions generated and can significantly decrease runtime by reducing the size of the optimization problem. One can pass in a vector of length max_degree specifying the number of knot points to use by interaction degree for each basis function. Thus, one can specify that two or three way interaction basis functions should be more coarse, which helps prevent the combinatorical explosion of basis functions that occurs when basis functions are generated for all possible knot points.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">98109</span><span class="op">)</span>
<span class="va">num_knots</span> <span class="op">&lt;-</span> <span class="fl">500</span> <span class="co"># Try changing this value to see what happens.</span>
<span class="va">n_covars</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">n_obs</span> <span class="op">&lt;-</span> <span class="fl">500</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span><span class="op">(</span><span class="va">n_covars</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">n_obs</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">4</span>, max <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n_obs</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>
<span class="va">ytrue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>

<span class="va">hal_fit_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formula_hal.html">fit_hal</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">x</span>, Y <span class="op">=</span> <span class="va">y</span>, fit_type <span class="op">=</span> <span class="st">"glmnet"</span>,
                     smoothness_orders <span class="op">=</span> <span class="fl">0</span>, num_knots <span class="op">=</span> <span class="va">num_knots</span>,
                     lambda.min.ratio <span class="op">=</span> <span class="fl">1e-4</span><span class="op">)</span>

<span class="va">hal_fit_smooth_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formula_hal.html">fit_hal</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">x</span>, Y <span class="op">=</span> <span class="va">y</span>, fit_type <span class="op">=</span> <span class="st">"glmnet"</span>,
                            smoothness_orders <span class="op">=</span> <span class="fl">1</span>,
                            num_knots <span class="op">=</span> <span class="va">num_knots</span>,
                            lambda.min.ratio <span class="op">=</span> <span class="fl">1e-4</span><span class="op">)</span>

<span class="va">hal_fit_smooth_2_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formula_hal.html">fit_hal</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">x</span>, Y <span class="op">=</span> <span class="va">y</span>, fit_type <span class="op">=</span> <span class="st">"glmnet"</span>,
                                smoothness_orders <span class="op">=</span> <span class="fl">2</span>,
                                num_knots <span class="op">=</span> <span class="va">num_knots</span>,
                                adaptive_smoothing <span class="op">=</span> <span class="cn">FALSE</span>,
                                cv_select <span class="op">=</span> <span class="cn">FALSE</span>,
                                lambda.min.ratio <span class="op">=</span> <span class="fl">1e-3</span><span class="op">)</span>

<span class="va">hal_fit_smooth_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formula_hal.html">fit_hal</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">x</span>, Y <span class="op">=</span> <span class="va">y</span>, fit_type <span class="op">=</span> <span class="st">"glmnet"</span>,
                           smoothness_orders <span class="op">=</span> <span class="fl">2</span>,
                           num_knots <span class="op">=</span> <span class="va">num_knots</span>,
                           adaptive_smoothing <span class="op">=</span> <span class="cn">FALSE</span>,
                           cv_select <span class="op">=</span> <span class="cn">TRUE</span>,
                           lambda.min.ratio <span class="op">=</span> <span class="fl">1e-4</span><span class="op">)</span>

<span class="va">pred_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">hal_fit_0</span>, new_data <span class="op">=</span> <span class="va">x</span><span class="op">)</span>
<span class="va">pred_smooth_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">hal_fit_smooth_1</span>, new_data <span class="op">=</span> <span class="va">x</span><span class="op">)</span>
<span class="va">pred_smooth_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">hal_fit_smooth_2</span>, new_data <span class="op">=</span> <span class="va">x</span><span class="op">)</span>

<span class="va">pred_smooth_2_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">hal_fit_smooth_2_all</span>, new_data <span class="op">=</span> <span class="va">x</span><span class="op">)</span>
<span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html">data.table</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>
<span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">dt</span>, <span class="va">pred_smooth_2_all</span><span class="op">)</span>
<span class="va">long</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/melt.data.table.html">melt</a></span><span class="op">(</span><span class="va">dt</span>, id <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">value</span>, group <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="intro_hal9001_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>Comparing the mean-squared-error between the predictions and the true (denoised) outcome, we see that the first and second order smoothness HAL is able to recover from the coarseness of the basis functions caused by the small <code>num_knots</code> argument. We see that the second order smoothness HAL is able to fit the true function very well (as expected since sin(x) is a very smooth function). The main benefit of imposing higher order smoothness is that fewer knot points are required for a near optimal fit. Thus one can pass a smaller value to the <code>num_knots</code> argument for a big decrease in runtime.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">pred_0</span> <span class="op">-</span> <span class="va">ytrue</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.003327325</code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">pred_smooth_1</span><span class="op">-</span> <span class="va">ytrue</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.0006370113</code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">pred_smooth_2</span> <span class="op">-</span> <span class="va">ytrue</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.0008864687</code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html">data.table</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
                 ytrue <span class="op">=</span> <span class="va">ytrue</span>,
                 y <span class="op">=</span> <span class="va">y</span>,
                 pred0 <span class="op">=</span> <span class="va">pred_0</span>,
                 pred1 <span class="op">=</span> <span class="va">pred_smooth_1</span>,
                 pred2 <span class="op">=</span> <span class="va">pred_smooth_2</span><span class="op">)</span>
<span class="va">long</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/melt.data.table.html">melt</a></span><span class="op">(</span><span class="va">dt</span>, id <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="intro_hal9001_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">pred_0</span>, main <span class="op">=</span> <span class="st">"Zero order smoothness fit"</span><span class="op">)</span></code></pre></div>
<p><img src="intro_hal9001_files/figure-html/unnamed-chunk-3-2.png" width="700"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">pred_smooth_1</span>, main <span class="op">=</span> <span class="st">"First order smoothness fit"</span><span class="op">)</span></code></pre></div>
<p><img src="intro_hal9001_files/figure-html/unnamed-chunk-3-3.png" width="700"></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">pred_smooth_2</span>, main <span class="op">=</span> <span class="st">"Second order smoothness fit"</span><span class="op">)</span></code></pre></div>
<p><img src="intro_hal9001_files/figure-html/unnamed-chunk-3-4.png" width="700"></p>
<p>In general, if we do not make the basis functions coarse, the performance for different smoothness orders is similar. Notice how the runtime is a fair bit slower when we generate more knot points. In general, we recommend either zero or first order smoothness. Second order smoothness tends to be less robust and suffers from extrapolation on new data. One can also use cross-validation to data-adaptively choose the optimal smoothness. Interestingly, comparing the following simulation and the previous one, we see that the second order smoothness HAL performed better when there were fewer knot points.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">98109</span><span class="op">)</span>
<span class="va">num_knots</span> <span class="op">&lt;-</span> <span class="fl">300</span>
<span class="va">n_covars</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">n_obs</span> <span class="op">&lt;-</span> <span class="fl">500</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span><span class="op">(</span><span class="va">n_covars</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">n_obs</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">4</span>, max <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n_obs</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>
<span class="va">ytrue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>

<span class="va">hal_fit_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formula_hal.html">fit_hal</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">x</span>, Y <span class="op">=</span> <span class="va">y</span>, fit_type <span class="op">=</span> <span class="st">"glmnet"</span>,
                           smoothness_orders <span class="op">=</span> <span class="fl">0</span>, num_knots <span class="op">=</span> <span class="va">num_knots</span><span class="op">)</span>
<span class="va">hal_fit_smooth_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formula_hal.html">fit_hal</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">x</span>, Y <span class="op">=</span> <span class="va">y</span>, fit_type <span class="op">=</span> <span class="st">"glmnet"</span>,
                           smoothness_orders <span class="op">=</span> <span class="fl">1</span>, num_knots <span class="op">=</span> <span class="va">num_knots</span><span class="op">)</span>

<span class="va">hal_fit_smooth_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formula_hal.html">fit_hal</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">x</span>, Y <span class="op">=</span> <span class="va">y</span>, fit_type <span class="op">=</span> <span class="st">"glmnet"</span>,
                           smoothness_orders <span class="op">=</span> <span class="fl">2</span>, num_knots <span class="op">=</span> <span class="va">num_knots</span><span class="op">)</span>

<span class="va">pred_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">hal_fit_0</span>, new_data <span class="op">=</span> <span class="va">x</span><span class="op">)</span>
<span class="va">pred_smooth_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">hal_fit_smooth_1</span>, new_data <span class="op">=</span> <span class="va">x</span><span class="op">)</span>
<span class="va">pred_smooth_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">hal_fit_smooth_2</span>, new_data <span class="op">=</span> <span class="va">x</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">pred_0</span> <span class="op">-</span> <span class="va">ytrue</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.003323484</code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">pred_smooth_1</span><span class="op">-</span> <span class="va">ytrue</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.0006508832</code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">pred_smooth_2</span> <span class="op">-</span> <span class="va">ytrue</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.0008376741</code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">pred_0</span>, main <span class="op">=</span> <span class="st">"Zero order smoothness fit"</span><span class="op">)</span></code></pre></div>
<p><img src="intro_hal9001_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">pred_smooth_1</span>, main <span class="op">=</span> <span class="st">"First order smoothness fit"</span><span class="op">)</span></code></pre></div>
<p><img src="intro_hal9001_files/figure-html/unnamed-chunk-5-2.png" width="700"></p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">pred_smooth_2</span>, main <span class="op">=</span> <span class="st">"Second order smoothness fit"</span><span class="op">)</span></code></pre></div>
<p><img src="intro_hal9001_files/figure-html/unnamed-chunk-5-3.png" width="700"></p>
<p>Note for higher dimensional models, one can specify the smoothness in each variable by passing in a vector of smoothness orders of length <code><a href="https://rdrr.io/r/base/nrow.html">ncol(X)</a></code>. See documentation for more details.</p>
</div>
<div id="formula-interface" class="section level3">
<h3 class="hasAnchor">
<a href="#formula-interface" class="anchor"></a>Formula interface</h3>
<p>One might wish to specify the functional form of the HAL fit further. This can be done using the formula interface. Specifically, the formula interface allows one to specify monotonicity constraints on components of the HAL fit, as well as specify exactly which basis functions (e.g., interactions) one wishes to model. First, we need to generate a formula object containing the necessary specification information. Later, we will see how to use this formula object to fit HAL. Note any arguments that one wishes to pass to <code>fit_hal</code> should be passed instead to the <code>formula_hal</code> function.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">98109</span><span class="op">)</span>
<span class="va">num_knots</span> <span class="op">&lt;-</span> <span class="fl">100</span>

<span class="va">n_obs</span> <span class="op">&lt;-</span> <span class="fl">500</span>
<span class="va">x1</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">n_obs</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">4</span>, max <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">n_obs</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">4</span>, max <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">n_obs</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">4</span>, max <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n_obs</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>
<span class="va">ytrue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>
<span class="co"># The formula interface requires us to input a data.frame with all variables</span>
<span class="co"># including outcome.</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="va">x1</span>, x2 <span class="op">=</span> <span class="va">x2</span>, A <span class="op">=</span> <span class="va">A</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span></code></pre></div>
<p>We can specify an additive model in a number of ways. We can print the formula object obtained by calling <code>formula_hal</code> to see some helpful information about our HAL specification.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formula_hal.html">formula_hal</a></span><span class="op">(</span><span class="st">"y ~ h(x1) + h(x2) + h(A)"</span>, <span class="va">data</span>,
                       smoothness_orders <span class="op">=</span> <span class="fl">1</span>, num_knots <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">formula</span>, expand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## Functional specification for hal9001 fit:
##  Call: y ~ h(x1) + h(x2) + h(A)
##  Formula: y ~ h(x1) + h(x2) + h(A)
##  Expanded Formula: y ~ h(x1) + h(x2) + h(A)
##  Number of smooth variables: 3
##  Smoothness range: 1 -&gt; 1 
##  Number of basis functions: 300
##  Number of monotone-increasing basis functions: 0
##  Number of monotone-decreasing basis functions: 0</code></pre>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">" "</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] " "</code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formula_hal.html">formula_hal</a></span><span class="op">(</span><span class="st">"y ~ ."</span>, <span class="va">data</span>, smoothness_orders <span class="op">=</span> <span class="fl">1</span>, num_knots <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">formula</span>, expand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## Functional specification for hal9001 fit:
##  Call: y ~ .
##  Formula: y ~ .
##  Expanded Formula: y ~ h(x1) + h(x2) + h(A)
##  Number of smooth variables: 3
##  Smoothness range: 1 -&gt; 1 
##  Number of basis functions: 300
##  Number of monotone-increasing basis functions: 0
##  Number of monotone-decreasing basis functions: 0</code></pre>
<p>We can specify higher order interactions as follows.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formula_hal.html">formula_hal</a></span><span class="op">(</span>
  <span class="st">"y ~ h(x1) + h(x2) + h(A) + h(x1, x2) + h(x2, A) + h(x1, A) + h(x1, x2, A)"</span>,
  <span class="va">data</span>, smoothness_orders <span class="op">=</span> <span class="fl">1</span>, num_knots <span class="op">=</span> <span class="fl">100</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">formula</span><span class="op">$</span><span class="va">formula_expanded</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "y ~ h(x1) + h(x2) + h(A) + h(x1,x2) + h(x2,A) + h(x1,A) + h(x1,x2,A)"</code></pre>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formula_hal.html">formula_hal</a></span><span class="op">(</span><span class="st">"y ~ .^2"</span>, <span class="va">data</span>, smoothness_orders <span class="op">=</span> <span class="fl">1</span>, num_knots <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">formula</span><span class="op">$</span><span class="va">formula_expanded</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "y ~ h(x1) + h(x2) + h(A) + h(x1,x2) + h(x1,A) + h(x2,A)"</code></pre>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formula_hal.html">formula_hal</a></span><span class="op">(</span><span class="st">"y ~ .^3"</span>, <span class="va">data</span>, smoothness_orders <span class="op">=</span> <span class="fl">1</span>, num_knots <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">formula</span><span class="op">$</span><span class="va">formula_expanded</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "y ~ h(x1) + h(x2) + h(A) + h(x1,x2) + h(x1,A) + h(x2,A) + h(x1,x2,A)"</code></pre>
<p>Sometimes, you may want to build an additive model but include all two way interactions with one variable “A” (e.g., treatment). This can be done in a variety of ways as follows.</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Write it all out</span>
<span class="va">formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formula_hal.html">formula_hal</a></span><span class="op">(</span><span class="st">"y ~ h(x1) + h(x2) + h(A) + h(A, x1) + h(A,x2)"</span>, <span class="va">data</span>,
                       smoothness_orders <span class="op">=</span> <span class="fl">1</span>, num_knots <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">formula</span><span class="op">$</span><span class="va">formula_expanded</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "y ~ h(x1) + h(x2) + h(A) + h(x1,A) + h(x2,A)"</code></pre>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Use the "." which stands for add all additive terms and then manually add</span>
<span class="co"># interactions</span>
<span class="va">formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formula_hal.html">formula_hal</a></span><span class="op">(</span><span class="st">"y ~ . + h(A,x1) + h(A,x2)"</span>, <span class="va">data</span>,
                       smoothness_orders <span class="op">=</span> <span class="fl">1</span>, num_knots <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">formula</span><span class="op">$</span><span class="va">formula_expanded</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "y ~ h(x1) + h(x2) + h(A) + h(x1,A) + h(x2,A)"</code></pre>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Use the "wildcard" feature for when "." is included in the "h()" term. This</span>
<span class="co"># useful when you have many variables and do not want to write out every term.</span>
<span class="va">formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formula_hal.html">formula_hal</a></span><span class="op">(</span><span class="st">"y ~ . + h(A,.)"</span>, <span class="va">data</span>, smoothness_orders <span class="op">=</span><span class="fl">1</span>,
                       num_knots <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">formula</span><span class="op">$</span><span class="va">formula_expanded</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "y ~ h(x1) + h(x2) + h(A) + h(x1,A) + h(x2,A)"</code></pre>
<p>Here are some other shortcuts inspired by the glm formula interace.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># The "*" operation generates lower order interactions as well.</span>
<span class="va">formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formula_hal.html">formula_hal</a></span><span class="op">(</span><span class="st">"y ~ h(x1)*h(x2)"</span>, <span class="va">data</span>,
                       smoothness_orders <span class="op">=</span> <span class="fl">1</span>, num_knots <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">formula</span><span class="op">$</span><span class="va">formula_expanded</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "y ~ h(x1) + h(x2) + h(x1,x2)"</code></pre>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formula_hal.html">formula_hal</a></span><span class="op">(</span><span class="st">"y ~ h(x1) + h(x2) + h(x1,x2)"</span>, <span class="va">data</span>,
                       smoothness_orders <span class="op">=</span> <span class="fl">1</span>, num_knots <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">formula</span><span class="op">$</span><span class="va">formula_expanded</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "y ~ h(x1) + h(x2) + h(x1,x2)"</code></pre>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># The ":" operator generates an interaction term.</span>
<span class="va">formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formula_hal.html">formula_hal</a></span><span class="op">(</span><span class="st">"y ~ h(x1) + h(x2) + h(x1):h(x2)"</span>, <span class="va">data</span>,
                       smoothness_orders <span class="op">=</span> <span class="fl">1</span>, num_knots <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">formula</span><span class="op">$</span><span class="va">formula_expanded</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "y ~ h(x1) + h(x2) + h(x1,x2)"</code></pre>
<p>Another interesting feature allows one to define custom wildcard symbols analagous to “.” that specifies groups, using the <code>custom_group</code> argument. The custom group argument should be a named list (with one character names) whose elements are character vectors of variable names. This allows one to generate interactions between user supplied groups.</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">custom_group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"a"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x1"</span>, <span class="st">"x2"</span><span class="op">)</span>, <span class="st">"b"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span><span class="op">)</span><span class="op">)</span>
<span class="va">formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formula_hal.html">formula_hal</a></span><span class="op">(</span><span class="st">"y ~ h(a)"</span>, <span class="va">data</span>, smoothness_orders <span class="op">=</span> <span class="fl">1</span>,
                       num_knots <span class="op">=</span> <span class="fl">100</span>, custom_group <span class="op">=</span> <span class="va">custom_group</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">formula</span><span class="op">$</span><span class="va">formula_expanded</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "y ~ h(x1) + h(x2)"</code></pre>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formula_hal.html">formula_hal</a></span><span class="op">(</span><span class="st">"y ~ h(a, b)"</span>, <span class="va">data</span>, smoothness_orders <span class="op">=</span> <span class="fl">1</span>,
                       num_knots <span class="op">=</span> <span class="fl">100</span>, custom_group <span class="op">=</span> <span class="va">custom_group</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">formula</span><span class="op">$</span><span class="va">formula_expanded</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "y ~ h(x1,A) + h(x2,A)"</code></pre>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formula_hal.html">formula_hal</a></span><span class="op">(</span><span class="st">"y ~ h(a) + h(a, b)"</span>, <span class="va">data</span>, smoothness_orders <span class="op">=</span> <span class="fl">1</span>,
                       num_knots <span class="op">=</span> <span class="fl">100</span>, custom_group <span class="op">=</span> <span class="va">custom_group</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">formula</span><span class="op">$</span><span class="va">formula_expanded</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "y ~ h(x1) + h(x2) + h(x1,A) + h(x2,A)"</code></pre>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formula_hal.html">formula_hal</a></span><span class="op">(</span><span class="st">"y ~ h(a, b, x1)"</span>, <span class="va">data</span>, smoothness_orders <span class="op">=</span> <span class="fl">1</span>,
                       num_knots <span class="op">=</span> <span class="fl">100</span>, custom_group <span class="op">=</span> <span class="va">custom_group</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">formula</span><span class="op">$</span><span class="va">formula_expanded</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "y ~ h(x1,x2,A)"</code></pre>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formula_hal.html">formula_hal</a></span><span class="op">(</span><span class="st">"y ~ h(a, b, a)"</span>, <span class="va">data</span>, smoothness_orders <span class="op">=</span> <span class="fl">1</span>,
                       num_knots <span class="op">=</span> <span class="fl">100</span>, custom_group <span class="op">=</span> <span class="va">custom_group</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">formula</span><span class="op">$</span><span class="va">formula_expanded</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "y ~ h(x1,x2,A)"</code></pre>
<p>So far we have ignored a key feature of the formula interface that is not available in the generic <code>fit_hal</code> function: monotonicity constraints. This is done by replacing the “h” with either “i” (for monotonely increasing) or “d” (for monotonely decreasing). It’s simple.</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># An additive monotone increasing model</span>
<span class="va">formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formula_hal.html">formula_hal</a></span><span class="op">(</span><span class="st">"y ~ i(.)"</span>, <span class="va">data</span>, smoothness_orders <span class="op">=</span> <span class="fl">1</span>,
                       num_knots <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">formula</span>, expand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## Functional specification for hal9001 fit:
##  Call: y ~ i(.)
##  Formula: y ~ i(.)
##  Expanded Formula: y ~ i(x1) + i(x2) + i(A)
##  Number of smooth variables: 3
##  Smoothness range: 1 -&gt; 1 
##  Number of basis functions: 300
##  Number of monotone-increasing basis functions: 300
##  Number of monotone-decreasing basis functions: 0</code></pre>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">" "</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] " "</code></pre>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># A bi-additive monotone decreasing model</span>
<span class="va">formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formula_hal.html">formula_hal</a></span><span class="op">(</span><span class="st">"y ~ d(.) + d(.,.)"</span>, <span class="va">data</span>, smoothness_orders <span class="op">=</span> <span class="fl">1</span>,
                       num_knots <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">formula</span>, expand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## Functional specification for hal9001 fit:
##  Call: y ~ d(.) + d(.,.)
##  Formula: y ~ d(.) + d(.,.)
##  Expanded Formula: y ~ d(x1) + d(x2) + d(A) + d(x1,x2) + d(x1,A) + d(x2,A)
##  Number of smooth variables: 3
##  Smoothness range: 1 -&gt; 1 
##  Number of basis functions: 1779
##  Number of monotone-increasing basis functions: 0
##  Number of monotone-decreasing basis functions: 1779</code></pre>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">" "</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] " "</code></pre>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># mix it up</span>
<span class="va">formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formula_hal.html">formula_hal</a></span><span class="op">(</span><span class="st">"y ~ d(x1) + i(x2) + h(A) + h(.,.)"</span>, <span class="va">data</span>,
                       smoothness_orders <span class="op">=</span> <span class="fl">1</span>, num_knots <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">formula</span>, expand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## Functional specification for hal9001 fit:
##  Call: y ~ d(x1) + i(x2) + h(A) + h(.,.)
##  Formula: y ~ d(x1) + i(x2) + h(A) + h(.,.)
##  Expanded Formula: y ~ d(x1) + i(x2) + h(A) + h(x1,x2) + h(x1,A) + h(x2,A)
##  Number of smooth variables: 3
##  Smoothness range: 1 -&gt; 1 
##  Number of basis functions: 1779
##  Number of monotone-increasing basis functions: 100
##  Number of monotone-decreasing basis functions: 100</code></pre>
<p>Now, let’s fit some custom HALs. This is easy using the S3-class-based <code>fit_hal</code> function:</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># get formula object</span>
<span class="va">formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formula_hal.html">formula_hal</a></span><span class="op">(</span><span class="st">"y ~ ."</span>, <span class="va">data</span>, smoothness_orders <span class="op">=</span> <span class="fl">1</span>, num_knots <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formula_hal.html">fit_hal_formula</a></span><span class="op">(</span><span class="va">formula</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit</span>, new_data <span class="op">=</span> <span class="va">formula</span><span class="op">$</span><span class="va">X</span><span class="op">)</span>, <span class="va">formula</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span></code></pre></div>
<p><img src="intro_hal9001_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
</div>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-benkeser2016hal">
<p>Benkeser, David, and Mark J van der Laan. 2016. “The Highly Adaptive Lasso Estimator.” In <em>2016 IEEE International Conference on Data Science and Advanced Analytics (DSAA)</em>. IEEE. <a href="https://doi.org/10.1109/dsaa.2016.93">https://doi.org/10.1109/dsaa.2016.93</a>.</p>
</div>
<div id="ref-vdl2017finite">
<p>van der Laan, Mark J. 2017. “Finite Sample Inference for Targeted Learning.” <a href="https://arxiv.org/abs/1708.09502">https://arxiv.org/abs/1708.09502</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jeremy Coyle, Nima Hejazi, Mark van der Laan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
